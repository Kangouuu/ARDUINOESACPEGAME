#include <Adafruit_NeoPixel.h>

#define BUTTON_PIN_1   8    // Button connected to D8 (Red LED)
#define BUTTON_PIN_2   6    // Button connected to D6 (Green LED)
#define BUTTON_PIN_3   2    // Button connected to D2 (Blue LED)

// Define LEDs for each button separately, with their respective pins
Adafruit_NeoPixel led1 = Adafruit_NeoPixel(1, 9, NEO_GRB + NEO_KHZ800);    // Red LED for button 1 (connected to pin 9)
Adafruit_NeoPixel led2 = Adafruit_NeoPixel(1, 7, NEO_GRB + NEO_KHZ800);    // Green LED for button 2 (connected to pin 7)
Adafruit_NeoPixel led3 = Adafruit_NeoPixel(1, 3, NEO_GRB + NEO_KHZ800);    // Blue LED for button 3 (connected to pin 5)

bool oldState1 = LOW;
bool oldState2 = LOW;
bool oldState3 = LOW;

void setup() {
  pinMode(BUTTON_PIN_1, INPUT_PULLUP);  // Button 1 on D8
  pinMode(BUTTON_PIN_2, INPUT_PULLUP);  // Button 2 on D6
  pinMode(BUTTON_PIN_3, INPUT_PULLUP);  // Button 3 on D2

  // Initialize LEDs
  led1.begin();
  led1.clear();  // Start with LED off
  led2.begin();
  led2.clear();  // Start with LED off
  led3.begin();
  led3.clear();  // Start with LED off
  
  Serial.begin(9600);  // Start serial communication for debugging
}

void loop() {
  // Read the current state of the buttons
  bool newState1 = digitalRead(BUTTON_PIN_1);
  bool newState2 = digitalRead(BUTTON_PIN_2);
  bool newState3 = digitalRead(BUTTON_PIN_3);

  // Debugging: print button states to the Serial Monitor
  Serial.print("Button 1 state: ");
  Serial.print(newState1);
  Serial.print(" Button 2 state: ");
  Serial.print(newState2);
  Serial.print(" Button 3 state: ");
  Serial.println(newState3);

  // Check for button 1 press (Red LED)
  if (newState1 == LOW && oldState1 == HIGH) {  // Button pressed (active low)
    // Toggle Red LED on/off
    if (led1.getPixelColor(0) == led1.Color(255, 0, 0)) {
      led1.setPixelColor(0, led1.Color(0, 0, 0));  // Turn off Red LED
    } else {
      led1.setPixelColor(0, led1.Color(255, 0, 0));  // Turn on Red LED
    }
    led1.show();
  }
  
  // Check for button 2 press (Green LED)
  if (newState2 == LOW && oldState2 == HIGH) {  // Button pressed (active low)
    // Toggle Green LED on/off
    if (led2.getPixelColor(0) == led2.Color(0, 255, 0)) {
      led2.setPixelColor(0, led2.Color(0, 0, 0));  // Turn off Green LED
    } else {
      led2.setPixelColor(0, led2.Color(0, 255, 0));  // Turn on Green LED
    }
    led2.show();
  }

  // Check for button 3 press (Blue LED)
  if (newState3 == LOW && oldState3 == HIGH) {  // Button pressed (active low)
    // Toggle Blue LED on/off
    if (led3.getPixelColor(0) == led3.Color(0, 0, 255)) {
      led3.setPixelColor(0, led3.Color(0, 0, 0));  // Turn off Blue LED
    } else {
      led3.setPixelColor(0, led3.Color(0, 0, 255));  // Turn on Blue LED
    }
    led3.show();
  }

  // Save the current states for the next loop
  oldState1 = newState1;
  oldState2 = newState2;
  oldState3 = newState3;

  delay(0); // Add a small delay to debounce the buttons
}
